# coding: utf-8
{{>partial_header}}

import boto3
from botocore.auth import SigV4Auth
from botocore.awsrequest import AWSRequest
from botocore.compat import (parse_qsl, urlparse)


class AwsSigv4Configuration(object):
    """The configuration parameters for the AWS Signature V4 security scheme.
    The AWS Signature V4 security scheme is used to sign HTTP requests with a signature generated
    using AWS credentials. The credentials used must have valid access to the service_name being called
    and access to the resource

    NOTE: This class is auto generated by OpenAPI Generator

    Ref: https://openapi-generator.tech
    Do not edit the class manually.

    :param service_name: A string value specifying the AWS service your HTTP call is attempting to access
    :param boto3_session: A boto3.Session object that contains credentials and access information for
        calling AWS apis to sign the specified request

    """

    def __init__(self, service_name='execute-api',
                       boto3_session=None):
        self.service_name = service_name
        if boto3_session is None:
            raise Exception("A boto3.Session must be provided")
        self.boto3_session = boto3_session

        self.sigv4 = SigV4Auth(
            credentials=self.boto3_session.get_credentials(),
            service_name=self.service_name,
            region_name=self.boto3_session.region_name,
        )

    def get_aws_signature_v4_headers(self, method, url, body):
        """ Create a signed signature header and accompanying date and checksum
            headers used in the AWS Signature V4 signing

            :param method: A string representation of the HTTP request method, e.g. GET, POST.
            :param url: A string representing the full HTTP request URL
            :param body: The object representing the HTTP request body.
        """
        aws_request = AWSRequest(
            method=method,
            url=url,
            data=body,
        )

        self.sigv4.add_auth(aws_request)
        return aws_request.headers
